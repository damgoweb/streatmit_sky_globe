# 世界の「今の空」を見る地球儀アプリ - 詳細要求仕様

## 1. プロジェクト概要

### 1.1 アプリケーション名
**Sky Globe - 世界の今の空**

### 1.2 目的
- 世界各地の現在の天気を直感的に理解できる教育・観光支援ツール
- 3D地球儀上でリアルタイムの気象情報を視覚化
- 地球の昼夜サイクルと天気の関係を学べるインタラクティブ体験

### 1.3 対象ユーザー
- 小中高校生（地理・理科教育）
- 教育者（授業教材として）
- 旅行者・観光客（目的地の天気確認）
- 一般ユーザー（世界の天気への興味）

## 2. 機能要求仕様

### 2.1 コア機能

#### 2.1.1 3D地球儀表示機能
- **技術**: pydeck + Streamlit
- **表示内容**:
  - 3D地球儀モデル（回転・ズーム・パン操作対応）
  - 国境線、主要都市名の表示
  - 昼夜境界線の表示（リアルタイム更新）
  - 昼側：明るい地表テクスチャ
  - 夜側：暗い地表テクスチャ + 都市光点

#### 2.1.2 天気情報表示機能
- **データソース**: OpenWeatherMap API
- **表示要素**:
  - 気温（°C/°F切替可能）
  - 天候アイコン（晴れ、曇り、雨、雪など）
  - 湿度、風速、気圧（詳細モード）
  - 体感温度
  - 可視性（視程）

#### 2.1.3 都市検索・選択機能
- **都市検索**:
  - 都市名による検索（日本語・英語対応）
  - 国名による絞り込み
  - 検索候補のオートコンプリート
- **ランダム選択**:
  - 「ランダム都市」ボタンで世界の任意都市を表示
  - 大陸別ランダム選択オプション

### 2.2 拡張機能

#### 2.2.1 時間軸機能
- 現在時刻の表示（選択都市のローカル時間）
- 昼夜境界線のリアルタイム更新（10分間隔）
- タイムゾーン表示

#### 2.2.2 比較機能
- 複数都市の同時表示（最大5都市）
- 気温・天候の比較表示
- お気に入り都市の登録・管理

#### 2.2.3 教育支援機能
- 季節による昼夜の長さの説明
- 気候帯の色分け表示
- 天気予報（3日間）の表示
- 気象データのグラフ表示（気温推移など）

## 3. 技術仕様

### 3.1 使用技術スタック
- **フロントエンド**: Streamlit
- **3D可視化**: pydeck (Deck.gl)
- **天気API**: OpenWeatherMap API
- **地図データ**: Natural Earth データ
- **言語**: Python 3.8+

### 3.2 必要ライブラリ
```python
streamlit>=1.28.0
pydeck>=0.8.0
requests>=2.31.0
pandas>=2.0.0
numpy>=1.24.0
pytz>=2023.3
geopy>=2.3.0
```

### 3.3 APIキー管理
- OpenWeatherMap APIキー（無料プラン: 1000calls/day）
- Streamlit Secretsによる安全な管理

## 4. UI/UX設計

### 4.1 レイアウト構成
```
┌─────────────────────────────────────────┐
│ タイトル: Sky Globe - 世界の今の空      │
├─────────────────────────────────────────┤
│ [サイドバー]           │ [メイン表示]   │
│ ┌─────────────────┐   │ ┌─────────────┐ │
│ │ 都市検索         │   │ │             │ │
│ │ [検索ボックス]   │   │ │             │ │
│ │ [ランダム選択]   │   │ │   3D地球儀  │ │
│ │                 │   │ │             │ │
│ │ 選択都市情報     │   │ │             │ │
│ │ ・都市名         │   │ │             │ │
│ │ ・現在時刻       │   │ └─────────────┘ │
│ │ ・気温           │   │                 │
│ │ ・天候           │   │ [天気詳細情報]  │
│ │ ・その他詳細     │   │                 │
│ │                 │   │                 │
│ │ 設定             │   │                 │
│ │ ・温度単位       │   │                 │
│ │ ・表示言語       │   │                 │
│ └─────────────────┘   │                 │
└─────────────────────────────────────────┘
```

### 4.2 カラーパレット
- **昼側地球**: 青系（#4A90E2）+ 緑系（#7ED321）
- **夜側地球**: 濃紺（#2C3E50）+ 暖色都市光（#F5A623）
- **UI背景**: ダークブルー（#1E2A3A）
- **テキスト**: 白（#FFFFFF）、グレー（#BDC3C7）

### 4.3 アニメーション
- 地球儀の自動回転（ON/OFF切替可能）
- 都市選択時のスムーズな視点移動
- 天気アイコンの微細なアニメーション

## 5. データ仕様

### 5.1 都市データ
- 約500の主要都市データ（緯度経度、名前、国名、タイムゾーン）
- CSV形式で管理
- 日本語・英語の都市名対応

### 5.2 天気データ構造
```json
{
  "city": "Tokyo",
  "country": "JP",
  "coordinates": [139.6917, 35.6895],
  "weather": {
    "main": "Clear",
    "description": "clear sky",
    "icon": "01d",
    "temperature": 25.5,
    "feels_like": 27.2,
    "humidity": 60,
    "pressure": 1013,
    "wind_speed": 3.2,
    "visibility": 10000
  },
  "timezone": "Asia/Tokyo",
  "local_time": "2024-03-15T14:30:00"
}
```

## 6. パフォーマンス要件

### 6.1 応答時間
- 初期画面表示: 3秒以内
- 都市検索・選択: 1秒以内
- 天気データ更新: 2秒以内
- 地球儀回転・操作: 60FPS維持

### 6.2 データ更新頻度
- 天気データ: 10分間隔
- 昼夜境界線: 10分間隔
- ユーザー操作への応答: リアルタイム

## 7. 教育的価値

### 7.1 学習効果
- 地球の球体性の理解
- 時差の概念の習得
- 気候・天候の地域差の認識
- 地理的位置感覚の向上

### 7.2 活用シーン
- 小学校社会科（世界の国々）
- 中学校理科（地球と宇宙）
- 高校地理（世界の気候）
- 国際交流イベント
- 旅行計画の立案

## 8. 今後の拡張可能性

### 8.1 追加機能アイデア
- 衛星画像の重ね合わせ表示
- 過去の天気データとの比較
- 気象災害情報の表示
- ユーザーの現在地自動取得
- SNS共有機能
- 多言語対応の拡充

### 8.2 技術的改善
- WebGLによるより高速な3D描画
- PWA化によるオフライン対応
- モバイル最適化
- VR/AR対応の検討

## 9. 成功指標（KPI）

### 9.1 利用指標
- 月間アクティブユーザー数
- セッション時間
- 都市検索回数
- ランダム機能利用率

### 9.2 教育効果指標
- 教育機関からの利用申込数
- ユーザーフィードバックスコア
- 継続利用率